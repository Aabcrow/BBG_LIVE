<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <template id="e9_report_sale_order_document_inherit" inherit_id="sale.report_saleorder_document">
            <div id='informations' position="replace">

            </div>
            <!--            <xpath expr="//t[@t-set='address']/t" position="replace"/>-->
            <xpath expr="//div/h2" position="replace"/>
            <xpath expr="/t//t[@t-set='information_block']" position="replace"/>
            <xpath expr="//t[@t-set='address']" position="replace">
                <div class="col-12 row">
                    <div class="col-6">
                        <b>To :</b>
                        <br/>
                        <div t-field="doc.partner_id"
                             t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: True}"/>
                        <p t-if="doc.partner_id.vat"><t
                                t-esc="doc.company_id.account_fiscal_country_id.vat_label or 'Tax ID'"/>:
                            <span t-field="doc.partner_id.vat"/>
                        </p>
                        <t t-if="doc.partner_shipping_id == doc.partner_invoice_id and doc.partner_invoice_id != doc.partner_id or doc.partner_shipping_id != doc.partner_invoice_id">
                            <strong t-if="doc.partner_shipping_id == doc.partner_invoice_id">Invoicing and Shipping
                                Address:
                            </strong>
                            <strong t-if="doc.partner_shipping_id != doc.partner_invoice_id">Invoicing Address:</strong>
                            <div t-field="doc.partner_invoice_id"
                                 t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
                            <t t-if="doc.partner_shipping_id != doc.partner_invoice_id">
                                <strong>Shipping Address:</strong>
                                <div t-field="doc.partner_shipping_id"
                                     t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
                            </t>
                        </t>

                        <t t-set="projects" t-value="doc.order_line.mapped('project_id')"/>
                        <div t-if="projects">
                            <span>Project:
                                <t t-foreach="projects" t-as="project">
                                    <span t-esc="project.name"/>
                                    .
                                </t>
                            </span>
                        </div>
                    </div>
                    <div class="col-6">
                        <h3 class="mt16">
                            <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                                <span t-if="doc.state not in ['draft','sent']">Order #</span>
                                <span t-if="doc.state in ['draft','sent']">Quotation #</span>
                            </t>
                            <t t-if="env.context.get('proforma', False) or is_pro_forma">
                                <span>Pro-Forma Invoice #</span>
                            </t>
                            <span t-field="doc.name"/>
                        </h3>
                        <br/>
                        <div t-if="doc.date_order and doc.state not in ['draft','sent']">
                            <strong>Order Date:</strong>
                            <p class="m-0" t-field="doc.date_order"/>
                        </div>
                        <div>
                            <div t-if="doc.date_order and doc.state in ['draft','sent']">
                                <strong>Quotation Date:</strong>
                                <p class="m-0" t-field="doc.date_order"
                                   t-options="{&quot;widget&quot;: &quot;date&quot;}"/>
                            </div>
                        </div>
                        <div t-if="doc.user_id.name">
                            <strong>Salesperson:</strong>
                            <p class="m-0" t-field="doc.user_id"/>
                        </div>

                    </div>
                </div>
                <br/>
            </xpath>

            <xpath expr="//table[hasclass('o_main_table')]/thead//th[@name='th_description']" position="before">
                <th>NÂ°</th>
            </xpath>
            <xpath expr="//table[hasclass('o_main_table')]/tbody" position="before">
                <t t-set="i" t-value="0"/>
            </xpath>
            <xpath expr="//table[hasclass('o_main_table')]/tbody//td[@name='td_name']" position="before">

                <t t-set="i" t-value="i+1 if line.product_id else i"/>
                <td>
                    <span t-esc="i"/>
                </td>
            </xpath>
        </template>

    </data>
</odoo>